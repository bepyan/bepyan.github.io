---
title: 'Drag Carousel ë½€ê°œê¸°'
description: 'ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ Reactì—ì„œ í„°ì¹˜ë¡œ ìºëŸ¬ì…€ì„ ë§Œë“¤ì–´ ë³´ì!!!'
icon: ''
image: ''
tags:
  - Next.js
  - React
  - DOM
draft: false
date: 2022-10-08 15:02:55
---

## TL;DR

> ìºëŸ¬ì…€ì„ **ì¼ì • ê±°ë¦¬ì´ìƒ** dragì‹œí‚¤ë©´ í™”ë©´ì„ ë„˜ê¸´ë‹¤.

---

## ê¸°ë³¸ ì›ë¦¬ â€” Carousel ë™ì‘

ì—¬ëŸ¬ ë°©ì‹ìœ¼ë¡œ Carouselë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆì§€ë§Œ ì•„ë˜ì™€ ê°™ì€ í˜•íƒœë¡œ ê°„í¸í•˜ê²Œ ë§ˆí¬ì—…ì„ ì§œì.
cssëŠ” í¸ì˜ìƒ [**tailwindcss**](https://tailwindcss.com/)ë¥¼ ê°™ì´ ì‚¬ìš©í–ˆë‹¤.

```tsx
const imageList = [...];

const SLIDER_WIDTH = 400;
const SLIDER_HEIGHT = 400;

export default function CarouselExample() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [transX, setTransX] = useState(0);

  return (
    <>
      {/* Viewer */}
      <div
        className="overflow-hidden"
        style={{
          width: SLIDER_WIDTH,
          height: SLIDER_HEIGHT,
        }}
      >
        {/* Slider */}
        <div
          className="flex"
          style={{
            transform: `translateX(${-currentIndex * SLIDER_WIDTH + transX}px)`,
          }}
        >
          {/* Slide */}
          {imageList.map((url, i) => (
            <div key={i} className="flex-shrink-0">
              <img src={url} alt="img" width={SLIDER_WIDTH} draggable={false} />
            </div>
          ))}
        </div>
      </div>
    </>
  );
}
```

ë§ˆí¬ì—…ì„ ê·¸ë¦¼ìœ¼ë¡œ ì •ë¦¬í•˜ìë©´ ì•„ë˜ì™€ ê°™ë‹¤

![](https://velog.velcdn.com/images/bepyan/post/9c60a2a9-a65b-444b-bd66-0504dcf3fc14/image.png)

`Viewer`ëŠ” **ì•¡ì**ì™€ ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•˜ê³ 
ì‹¤ì§ˆì ìœ¼ë¡œ `Slider`ê°€ ì¢Œìš°ë¡œ `transform`í•˜ì—¬ ìºëŸ¬ì…€ ì›€ì§ì„ì„ êµ¬í˜„í•œë‹¤.

ë”°ë¼ì„œ ì‚¬ì „ì— `Slide`ì˜ í¬ê¸°ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤.
ë™ì ìœ¼ë¡œ í¬ê¸°ë¥¼ ë§ì¶œë ¤ë©´ `ref`ë¡œ `element.getBoundingClientRect`ì„ í˜¸ì¶œí•˜ë©´ ëœë‹¤.

---

## ê¸°ë³¸ ì‘ìš© â€” Carousel Drag

ìºëŸ¬ì…€ì„ **ì¼ì • ê±°ë¦¬ì´ìƒ drag**í•˜ë©´ í™”ë©´ì„ ë„˜ê¸´ë‹¤.
~~ì°¸ ì‰½ì£ ì‰?~~

![](https://velog.velcdn.com/images/bepyan/post/d73cc634-2819-4264-ae72-704a0252f24d/image.gif)

1. [ì´ì „ ê¸€](https://velog.io/@bepyan/Drag-Touch-ë½€ê°œê¸°#ì‹¬í™”-ì‘ìš©--ìµœì¢…-ì½”ë“œ)ì„ ì°¸ê³ í•˜ì—¬ ë“œë˜ê·¸ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
2. dragëœ ê±°ë¦¬ì— ë§Œí¼ `transX`ë¥¼ ì´ë™ì‹œí‚¨ë‹¤.
   í•œë²ˆì˜ dragë¡œ í•œ ìŠ¬ë¼ì´ë“œ ì´ìƒìœ¼ë¡œ ì´ë™í•  ìˆ˜ ì—†ë„ë¡ í•˜ì.
3. ì†ì„ ë• ì„ ë•Œ ì¼ì • ê±°ë¦¬ì´ìƒ ì›€ì§ì´ë©´ `currentIndex`ë¥¼ ë³€ê²½í•´ì¤€ë‹¤.
4. dragëœ `transX`ë¥¼ ì´ˆê¸°í™” í•´ì¤€ë‹¤.

```tsx
const inrange = (v: number, min: number, max: number) => {
  if (v < min) return min;
  if (v > max) return max;
  return v;
};
```

```jsx
<div
  className="flex"
  style={{
    transform: `translateX(${-currentIndex * SLIDER_WIDTH + transX}px)`,
    // ğŸ„ğŸ»â€â™‚ï¸  dragë¥¼ ì´ˆê¸°í™”í•  ë•Œ ë¶€ë“œëŸ½ê²Œ ì´ë™ì‹œì¼œ ì£¼ì. ê¼¼ìˆ˜ì…ë‹ˆë‹¤...
    transition: `transform ${transX ? 0 : 300}ms ease-in-out 0s`,
  }}
  // 1ï¸âƒ£
  {...registDragEvent({
    onDragChange: (deltaX) => {
      // 2ï¸âƒ£
      setTransX(inrange(deltaX, -SLIDER_WIDTH, SLIDER_WIDTH));
    },
    onDragEnd: (deltaX) => {
      const maxIndex = imageList.length - 1;

      // 3ï¸âƒ£
      if (deltaX < -100) setCurrentIndex(inrange(currentIndex + 1, 0, maxIndex));
      if (deltaX > 100) setCurrentIndex(inrange(currentIndex - 1, 0, maxIndex));

      // 4ï¸âƒ£
      setTransX(0);
    },
  })}
>
  //...
</div>
```

---

## ì‹¬í™” ì‘ìš© â€” Infinite Carousel

ë‹¨ê³¨ë¡œ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥ ì¤‘ì— í•˜ë‚˜ì´ë‹¤.
ë¬´í•œìœ¼ë¡œ ëŒì•„ê°€ëŠ” íŠ¸ë¦­ì€ ìƒê°ë³´ë‹¤ ê°„ë‹¨í•˜ë‹¤.

> ì²« ìŠ¬ë¼ì´ë“œ ì¢Œì¸¡ìœ¼ë¡œ ì´ë™ì‹œ ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œë¡œ,
> ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ ìš°ì¸¡ìœ¼ë¡œ ì´ë™ì‹œ ì²« ìŠ¬ë¼ì´ë“œë¡œ ì´ë™í•˜ë©´ ìºëŸ¬ì…€ì´ ë¬´í•œìœ¼ë¡œ ëŒì•„ê°ˆ ê²ƒì´ë‹¤.

ì, êµ¬í˜„ í•´ë³´ì!

ê¸°ì¡´ `[0, 1, 2, 3]` ë²ˆ ìŠ¬ë¼ì´ë“œë¥¼ `[3, 0, 1, 2, 3, 0]`ë¡œ ë§Œë“ ë‹¤.
ê·¸ë¦¬ê³  `index`ë¥¼ `1`ë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ì.

```tsx
const slideList = [imageList.at(-1), ...imageList, imageList.at(0)];
const [currentIndex, setCurrentIndex] = useState(1);
```

<br />

ìì—°ìŠ¤ëŸ½ê²Œ **ë¬´í•œë£¨í”„** ë˜ê¸° ìœ„í•´ì„  `currentIndex`ê°€ ì•„ë˜ì™€ ê°™ì´ ë™ì‘í•´ì•¼ í•œë‹¤.

```
1 â†’ 0  (ì—ë‹ˆë©”ë‹ˆì…˜ ì—†ì´) â†’ 4
```

`dragEnd`ì‹œ `currentIndex`ë¥¼ ë³€ë™í•˜ê²Œ ë  ê²ƒì´ë‹¤.
[**onTransitionEnd**](https://developer.mozilla.org/en-US/docs/Web/API/Element/transitionend_event)ì„ í™œìš©í•˜ì—¬ `transition`ì´ ì¢…ë£Œë ì‹œ `animate`ë¥¼ ë„ê³  `currentIndex`ë¥¼ ë³€ë™í•´ì¤€ë‹¤.

```tsx
const [animate, setAnimate] = useState(false);

<div
  style={{
    transform: `translateX(${-currentIndex * SLIDER_WIDTH + transX}px)`,
    transition: `transform ${animate ? 300 : 0}ms ease-in-out 0s`,
  }}
  {...({
  	onDragEnd: (deltaX) => {
      //...

      setAnimate(true);
      setTransX(0);
    }
  })}
  onTransitionEnd={() => {
	setAnimate(false);

    if (currentIndex === 0) {
      setCurrentIndex(slideList.length - 2);
    } else if (currentIndex === slideList.length - 1) {
      setCurrentIndex(1);
    }
  }}
>
  {...}
</div>
```

![](https://velog.velcdn.com/images/bepyan/post/7c638d6a-838a-4f70-9c1d-4517e9e0770b/image.gif)

---

## ìµœì¢… ì½”ë“œ

```tsx
const imageList = [
  'https://blog.kakaocdn.net/dn/dpxiAT/btqUBv6Fvpn/E8xUMncq7AVuDeOim0LrMk/img.jpg',
  'https://blog.kakaocdn.net/dn/BGT7X/btqUzvTqi5h/flp39GdJH0GU6mo7cTbbhk/img.jpg',
  'https://blog.kakaocdn.net/dn/bWnmfv/btqUBwqZvwA/3CiXGt3SR0TXoOveRJxV91/img.jpg',
  'https://blog.kakaocdn.net/dn/XsLCO/btqUL8PQLwp/NZWCU2jAYKkKSXwcohBKTK/img.jpg',
  'https://blog.kakaocdn.net/dn/bG3iVL/btqUvCZPaRL/ofIjkNWJP1mj2bOG9fie51/img.jpg',
];

const SLIDER_WIDTH = 400;
const SLIDER_HEIGHT = 400;

export default function CarouselInfiniteExample() {
  const slideList = [imageList.at(-1), ...imageList, imageList.at(0)];

  const [currentIndex, setCurrentIndex] = useState(1);
  const [transX, setTransX] = useState(0);
  const [animate, setAnimate] = useState(false);

  return (
    <>
      <div
        className="overflow-hidden"
        style={{
          width: SLIDER_WIDTH,
          height: SLIDER_HEIGHT,
        }}
      >
        <div
          className="flex"
          style={{
            transform: `translateX(${-currentIndex * SLIDER_WIDTH + transX}px)`,
            transition: `transform ${animate ? 300 : 0}ms ease-in-out 0s`,
          }}
          {...registDragEvent({
            onDragChange: (deltaX) => {
              setTransX(inrange(deltaX, -SLIDER_WIDTH + 10, SLIDER_WIDTH - 10));
            },
            onDragEnd: (deltaX) => {
              const maxIndex = slideList.length - 1;

              if (deltaX < -100) setCurrentIndex(inrange(currentIndex + 1, 0, maxIndex));
              if (deltaX > 100) setCurrentIndex(inrange(currentIndex - 1, 0, maxIndex));

              setAnimate(true);
              setTransX(0);
            },
          })}
          onTransitionEnd={() => {
            setAnimate(false);

            if (currentIndex === 0) {
              setCurrentIndex(slideList.length - 2);
            } else if (currentIndex === slideList.length - 1) {
              setCurrentIndex(1);
            }
          }}
        >
          {slideList.map((url, i) => (
            <div key={i} className="flex-shrink-0">
              <img src={url} alt="img" width={SLIDER_WIDTH} draggable={false} />
            </div>
          ))}
        </div>
      </div>
    </>
  );
}
```

---

ì‹¤ì œ ë™ì‘ì€ ì•„ë˜ ë§í¬ì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
https://dnd-playground.vercel.app/carousel

style ì •ë³´, ì „ì²´ ì½”ë“œëŠ” ì•„ë˜ ê¹ƒí—ˆë¸Œì—ì„œ ì‚´í´ë³´ë©´ ë©ë‹ˆë‹¤.
https://github.com/bepyan/dnd-playground/
